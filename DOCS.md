# **API Documentaiton**

### **POST /users/register**

This API endpoint registers user account. If registration is successfull it returns account details.

#### **Request Format**

*JSON Request Body Paramenters*

Parameter | Type | Description |
--- | --- | --- |
firstname (required) | String | Firstname of the user |
lastname | String | Lastname of the user |
email (required) | email | email id of user. Must be unique

<br/>

#### **Response Format**

Parameter | Type | Description |
--- | --- | --- |
__id_ | String |Unique objectID |
firstname | String | Firstname of the user |
lastname | String | Lastname of the user |
email | email | email id of user|
movies | Array | Array of movies object (see 1) |
followers | Array | Array of objectID in string format. Stores id of users who are following this user (see 2) |
following | Array | Array of objectID in string format. Stores id of users who are followed by this user (see 3)
feed | Array | Array of ObjectID in string format. Stores objectId of post generated by users who are in this user's following list (see 4)

<br/>

**1. movies**

Field| Type | Description |
--- | --- | --- |
__id_ | ObjectID |Unique objectID for each movie added in array |
movieid | Number |Unique movieid provided by [TMDB](https://www.themoviedb.org/) |
rating| Number |Rating given to movie by this user

<br/>

**2. followers**
Field| Type | Description |
--- | --- | --- |
userid | String | objectID in string format. Stores id of users who are following this user|

<br/>

**3. following**

Field| Type | Description |
--- | --- | --- |
userid | String | objectID in string format. Stores id of users who are followed by this user|

**4. feed**

Field| Type | Description |
--- | --- | --- |
postid | String | objectID in string format. Stores objectId of post generated by users who are in this user's following list

<br/>

### **GET /users/:userid**

Returns user information.

#### **Request Format**

*URL Paramenters*
Parameter | Description |
--- | --- |
userid |Unique objectID of user |
<br/>

#### **Response Format**

Parameter | Type | Description |
--- | --- | --- |
__id_ | String |Unique objectID of user |
firstname | String | Firstname of the user |
lastname | String | Lastname of the user |
email | email | email id of user|
movies | Array | Array of movies object |
followers | Array | Array of objectID in string format. Stores id of users who are following this user |
following | Array | Array of objectID in string format. Stores id of users who are followed by this user
feed | Array | Array of ObjectID in string format. Stores objectId of post generated by users who are in this user's following list

<br/>

### **POST /users/:userid/addmovie**

This API endpoint adds movie to user account. If request parameters are valid and successful:

 1. Request is automatically redirected to **POST /posts** which creates a post (do not confuse with POST method).

 2. The movie is added to 'movies' array of this user.

 3. This post is then added to 'feed' array in every users data who follow this user.

#### **Request Format**

*URL Paramenters*
Parameter | Description |
--- | --- |
userid|Unique objectID of user |
<br/>

*JSON Request Body Paramenters*

Parameter | Type | Description |
--- | --- | --- |
userid | String | Unique objectID of this user (This field will be removed in future as same userid is already provided in URL parameter) |
movieid | Number |Unique movieid provided by [TMDB](https://www.themoviedb.org/) |
rating| Number |Rating given to movie by this user
comment| String | Comment given by user to this movie

<br/>

#### **Response Format**

See **POST /posts**

<br/>

### **GET /users/:userid/movielist**

#### **Request Format**

*URL Paramenters*
Parameter | Description |
--- | --- |
userid|Unique objectID of user |
<br/>

*Query Paramenters*
Parameter | Description |
--- | --- |
orderby (optional) |Takes either of two values - 'time'  (default) or 'rating' |
<br/>

#### **Response Format**

Returns array of objects. If orderby query is 'time' then result is sorted by newest to oldes,  else if it is 'rating' then it is sorted by highest rating to lowest. Each object contains following fields:

Parameter | Type | Description |
--- | --- | --- |
time | String |Time at which current movie was added to list |
movieid | Number |Unique movieid provided by [TMDB](https://www.themoviedb.org/) |
rating| Number |Rating given to movie by this user
error | Error |Error returned if API calls to TMDB fails
movie | Object | This field contains movie details (see below). Is null if TMDB API call fails.

**movie**

Field| Type | Description |
--- | --- | --- |
id | Number |Unique movieid provided by [TMDB](https://www.themoviedb.org/) (same as movieid)|
title | String |Movie Title
overview | String |Movie Overview
release_date | String |Movie release date in string format
genres | Array of String |Move Genres
runtime | Number |Move runtime in minutes
vote_average | Number |Movie vote average by IMDB (NOT by user)
adult | Bool |true if movie is adult rated. false otherwise
poster_url | String | URL to Movie Poster

<br/>

### **POST /users/:userid/follow**

Follow a user (friend). Friend's unique ObjectID will be added to this user's following list (in userid field). This user's ObjectID will be added to friend's followers list.

#### **Request Format**

*URL Paramenters*
Parameter | Description |
--- | --- |
userid|Unique objectID of user |

<br/>

*JSON Request Body Paramenters*

Parameter | Type | Description |
--- | --- | --- |
friendid | String| Unique objectID of the user (friend) whom this user is going to follow

#### **Response Format**

If successfull, Status code OK 200 is returned

<br/>

### **GET /users/:userid/followers**

Returns detailed list of users who are following this user.

<br/>

### **GET /users/:userid/following**

Returns detailed list of users whom this user is following.
